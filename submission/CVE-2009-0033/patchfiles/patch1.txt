--- tomcat/tc6.0.x/trunk/java/org/apache/jk/common/ChannelNioSocket.java	2009/02/10 09:37:11	742914
+++ tomcat/tc6.0.x/trunk/java/org/apache/jk/common/ChannelNioSocket.java	2009/02/10 09:40:19	742915
@@ -56,6 +56,7 @@
 import org.apache.coyote.Request;
 import org.apache.coyote.RequestGroupInfo;
 import org.apache.coyote.RequestInfo;
+import org.apache.coyote.ActionCode;
 import org.apache.tomcat.util.threads.ThreadPool;
 import org.apache.tomcat.util.threads.ThreadPoolRunnable;
 
@@ -854,6 +855,7 @@
                     status= invoke( recv, ep );
                     if( status != JkHandler.OK ) {
                         log.warn("processCallbacks status " + status );
+                        ep.action(ActionCode.ACTION_CLOSE, ep.getRequest().getResponse());
                         return false;
                     }
                     synchronized(this) {
